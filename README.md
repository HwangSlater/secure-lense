# SecureLens - AI 기반 악성코드 및 스피어피싱 분석 플랫폼

SecureLens는 보안 전문가가 수동으로 수행하던 악성코드 분석 작업을 자동화하고, Gemini AI를 활용하여 분석 결과를 쉽게 이해할 수 있도록 설명해주는 웹 기반 분석 서비스입니다.

## 📋 주요 기능

### 핵심 기능

- ✅ **다중 엔진 악성코드 스캔**
  - ClamAV 바이러스 시그니처 탐지
  - YARA 패턴 매칭 규칙
  - 심층 바이너리 분석 (HxD와 유사한 자동화)
  - PE 헤더 이상 탐지

- ✅ **스피어피싱 탐지**
  - 이메일 헤더 분석 (From, Reply-To, Return-Path)
  - 발신자 위조 탐지
  - 한국어 피싱 키워드 탐지
  - 호모그래프 공격 탐지
  - 의심스러운 URL 추출
  - 이중 확장자 탐지

- ✅ **AI 기반 위협 설명**
  - Gemini 2.5 Flash 통합
  - 한국어 설명
  - 위험도 평가 및 권장사항
  - 실제 공격 사례 참조

- ✅ **크레딧 기반 AI 분석**
  - AI 분석 접근을 위한 크레딧 시스템
  - 관리자는 무제한 접근
  - 모의 결제 시스템

- ✅ **보안 기능**
  - 자동 파일 정리 (1시간 후 삭제)
  - 속도 제한 (IP당 시간당 10개 업로드)
  - 파일 격리 저장
  - 타임아웃 보호 (모든 스캔에 30초 제한)
  - 입력 검증 및 정제

### 지원 파일 형식

- **실행 파일**: `.exe`, `.dll`
- **문서**: `.pdf`, `.docx`
- **이메일**: `.eml`
- **압축 파일**: `.zip`

### 파일 크기 제한

- 최대: **50MB**

## 🎯 위험도 점수 계산

위험도 점수 (0-100)는 다음과 같이 계산됩니다:

- **ClamAV 탐지**: +40점
- **YARA 매칭**: +30점 (최대 30점)
- **쉘코드 패턴**: +20점
- **의심스러운 문자열**: +10점 (5개 이상 발견 시)
- **스피어피싱 지표**: +20점
  - 발신자 위조: +10점
  - 피싱 키워드: +20점 (키워드당 5점)
  - 이중 확장자: +10점
  - 다수의 의심스러운 URL: +10점

**위험도 등급**:
- 🟢 **매우 낮음** (0-20)
- 🟡 **낮음** (21-40)
- 🟠 **보통** (41-60)
- 🔴 **높음** (61-80)
- ⚫ **매우 높음** (81-100)

## 🎨 UI/UX 기능

- **한국어 인터페이스** - 모든 UI 텍스트가 한국어
- **반응형 디자인** - 모바일 친화적 레이아웃
- **실시간 진행 상황** - 업로드 진행률 표시기
- **색상 코딩된 위험도** - 시각적 위험도 평가
- **2열 레이아웃** - 기술 분석 + AI 인사이트
- **잠긴 AI 분석** - 크레딧 기반 접근 제어
- **분석 이력 관리** - 마이페이지에서 분석 내역 확인
- **크레딧 구매 내역** - 결제 내역 추적

## 🔐 사용자 역할

| 역할   | 사용자명 | 비밀번호 | 크레딧 | 권한 |
|--------|----------|----------|---------|------|
| 관리자 | admin    | admin123 | ∞       | 무제한 AI 분석 접근 |
| 사용자 | user     | user123  | 0       | 크레딧 충전 후 AI 분석 가능 |

## 🛡️ 보안 기능

### 파일 안전성

- **파일 실행 금지** - 정적 분석만 수행
- **격리 저장** - 파일은 격리된 디렉토리에 저장
- **자동 삭제** - 파일은 1시간 후 자동 삭제
- **크기 제한** - 최대 50MB 파일 크기
- **확장자 화이트리스트** - 허용된 파일 형식만

### API 보안

- **JWT 인증** - 토큰 기반 인증
- **속도 제한** - IP당 시간당 10개 업로드
- **입력 검증** - 모든 입력 검증 및 정제
- **타임아웃 보호** - 모든 스캔에 30초 타임아웃
- **오류 처리** - 사용자 친화적인 메시지로 우아한 오류 처리

## 📁 프로젝트 구조

```
SecureLens/
├── backend/              # FastAPI 백엔드
│   ├── main.py          # API 라우트 및 비즈니스 로직
│   ├── models.py        # 데이터베이스 모델
│   ├── auth.py          # JWT 인증
│   ├── analyzer.py      # 핵심 분석 엔진
│   └── rules/           # YARA 규칙 파일
├── frontend/            # Next.js 프론트엔드
│   ├── app/             # 페이지 라우팅
│   └── components/      # React 컴포넌트
└── tests/               # 테스트 파일
```

## 🌐 주요 기능 설명

### 파일 분석 프로세스

1. **파일 업로드**: 사용자가 의심스러운 파일을 업로드
2. **다중 엔진 스캔**: ClamAV, YARA, 바이너리 분석 동시 실행
3. **위험도 평가**: 탐지된 위협을 기반으로 위험도 점수 계산
4. **AI 심층 분석** (선택): 크레딧을 사용하여 Gemini AI로 상세 분석
5. **결과 표시**: 기술적 분석 결과와 AI 인사이트를 함께 제공

### 분석 결과 페이지

- **기술 분석**: ClamAV, YARA, 바이너리 분석 결과
- **AI 인사이트**: Gemini AI가 제공하는 위협 설명 및 권장사항
- **위험도 시각화**: 색상 코딩된 위험도 등급
- **상세 정보**: 각 탐지 항목에 대한 설명

### 마이페이지

- **분석 이력**: 사용자가 분석한 모든 파일의 내역
- **결제 내역**: 크레딧 구매 기록
- **크레딧 잔액**: 현재 보유한 분석 크레딧

## ⚠️ 중요 사항

1. **업로드된 파일 실행 금지** - 이것은 정적 분석 도구일 뿐입니다
2. **프로덕션 배포** - 적절한 보안 설정 및 시크릿 관리 필요
3. **ClamAV 연결** - ClamAV 서비스가 실행 중이고 접근 가능해야 함
4. **Gemini API** - AI 분석 기능을 사용하려면 유효한 API 키 필요
5. **파일 정리** - 파일은 1시간 후 자동으로 삭제됩니다

## 📚 기술 스택

- **Backend**: FastAPI, Python, SQLAlchemy, YARA, ClamAV
- **Frontend**: Next.js, React, TypeScript, Tailwind CSS
- **AI**: Google Gemini 2.5 Flash
- **Database**: MySQL
- **Infrastructure**: Docker, Nginx

## 📄 라이선스

이 프로젝트는 교육 및 보안 연구 목적으로만 사용됩니다.

---

**보안 전문가를 위해 ❤️로 만들어졌습니다**
