rule suspicious_shellcode {
    meta:
        description = "Detects common shellcode patterns"
    strings:
        $nop_sled = { 90 90 90 90 90 90 90 90 }
        $jmp_short = { EB FE }
    condition:
        any of them
}

rule credential_stealer {
    meta:
        description = "Detects potential credential stealing behavior"
    strings:
        $s1 = "password" nocase
        $s2 = "credential" nocase
        $s3 = "login" nocase
        $cmd = "cmd.exe" nocase
    condition:
        3 of them
}

